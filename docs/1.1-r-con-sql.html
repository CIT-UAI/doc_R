<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.1 R con SQL | Documentación de R</title>
  <meta name="description" content="Piloto de documentación con Bookdown" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="1.1 R con SQL | Documentación de R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Piloto de documentación con Bookdown" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.1 R con SQL | Documentación de R" />
  
  <meta name="twitter:description" content="Piloto de documentación con Bookdown" />
  

<meta name="author" content="Equipo de Investigación (?)" />


<meta name="date" content="2022-04-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="1-introduccion.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Documentación CIT</a></li>

<li class="divider"></li>
<li><a href="index.html#prefacio">Prefacio<span></span></a></li>
<li class="chapter" data-level="1" data-path="1-introduccion.html"><a href="1-introduccion.html"><i class="fa fa-check"></i><b>1</b> Introduccion<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-r-con-sql.html"><a href="1.1-r-con-sql.html"><i class="fa fa-check"></i><b>1.1</b> R con SQL<span></span></a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="1.1-r-con-sql.html"><a href="1.1-r-con-sql.html#conectarse-al-servidor"><i class="fa fa-check"></i><b>1.1.1</b> Conectarse al servidor<span></span></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Documentación de R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-con-sql" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> R con SQL<a href="1.1-r-con-sql.html#r-con-sql" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Se recomienda leer el primer capitulo introductorio a SQL antes de la siguiente sección.</p>
<div id="conectarse-al-servidor" class="section level3 hasAnchor" number="1.1.1">
<h3><span class="header-section-number">1.1.1</span> Conectarse al servidor<a href="1.1-r-con-sql.html#conectarse-al-servidor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Anteriormente usábamos st_read para leer archivos, ahora necesitaremos una pieza de código que se llama conexión.</p>
<p>Es quien le dirá al paquete sf y a R cómo acceder al servidor para que luego podamos recuperar datos, tambien pueden pensarlo como una forma de indicar la ruta del archivo, solo que como esta en otro PC, necesitaremos credenciales para que nos de los datos.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="1.1-r-con-sql.html#cb1-1" aria-hidden="true"></a><span class="kw">library</span>(sf)</span>
<span id="cb1-2"><a href="1.1-r-con-sql.html#cb1-2" aria-hidden="true"></a><span class="kw">library</span>(DBI)</span>
<span id="cb1-3"><a href="1.1-r-con-sql.html#cb1-3" aria-hidden="true"></a><span class="kw">library</span>(RPostgres)</span>
<span id="cb1-4"><a href="1.1-r-con-sql.html#cb1-4" aria-hidden="true"></a></span>
<span id="cb1-5"><a href="1.1-r-con-sql.html#cb1-5" aria-hidden="true"></a><span class="co"># Crear coneccion a PostgreSQL</span></span>
<span id="cb1-6"><a href="1.1-r-con-sql.html#cb1-6" aria-hidden="true"></a>con &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(RPostgres<span class="op">::</span><span class="kw">Postgres</span>(),</span>
<span id="cb1-7"><a href="1.1-r-con-sql.html#cb1-7" aria-hidden="true"></a>                 <span class="dt">host =</span> <span class="st">&#39;localhost&#39;</span>, <span class="co"># IP/Nombre de la pagina donde esta el servidor</span></span>
<span id="cb1-8"><a href="1.1-r-con-sql.html#cb1-8" aria-hidden="true"></a>                 <span class="dt">port =</span> <span class="dv">5432</span>, <span class="co"># Postgres usualmente usa este numero, solo cambiar si el servidor usa otro</span></span>
<span id="cb1-9"><a href="1.1-r-con-sql.html#cb1-9" aria-hidden="true"></a>                 <span class="dt">dbname =</span> <span class="st">&#39;testdb&#39;</span>, <span class="co"># Un servidor puede tener muchas bases de datos, nombre a la cual queremos acceder</span></span>
<span id="cb1-10"><a href="1.1-r-con-sql.html#cb1-10" aria-hidden="true"></a>                 <span class="dt">user =</span> <span class="st">&#39;user&#39;</span>, <span class="co"># Nombre de usuario para la base de datos</span></span>
<span id="cb1-11"><a href="1.1-r-con-sql.html#cb1-11" aria-hidden="true"></a>                 <span class="dt">password =</span> <span class="st">&#39;12345&#39;</span> <span class="co"># Clave para acceder a la base de datos</span></span>
<span id="cb1-12"><a href="1.1-r-con-sql.html#cb1-12" aria-hidden="true"></a>)</span></code></pre></div>
<p>Todos estos datos, deben ser dados con anterioridad para que te puedas contactar, es el nuevo equivalente a pasarte un archivo shp.</p>
<p>Como notarás, hay usuarios y claves, esto es por que cada usuario puede tener permisos diferentes.
Por mas que sea práctico poder acceder a todos los datos, hay que tener especial cuidado con cambiar
una base de datos de forma accidental, una forma de evitar esto es usando un usuario que solo puede leer datos.</p>
<p>Inevitablemente habrá que aprender un poco de SQL para gestionar la información, pero no te preocupes, que las funciones de SQL tienen casi los mismos nombres que en R.</p>
<p>SQL es un lenguaje para consultar y procesar grandes cantidades de información, debido a eso, la palabra que se usa es “Consulta”, donde literalmente consultamos datos, una consulta puede no solo leer, además puede pedir aplicar transformaciones a datos y diferentes funciones al servidor.</p>
<p>Las consultas esan el lenguaje de programación SQL, R tiene varias formas de simplificar esto sin tener que usar casi nada el lenguaje, aun así lo necesitaremos un poco.</p>
<p>Para leer una tabla se hace de la siguiente manera:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="1.1-r-con-sql.html#cb2-1" aria-hidden="true"></a>x&lt;-<span class="kw">st_read</span>(con, <span class="dt">query=</span><span class="st">&quot;SELECT * FROM comunas_chile</span></span>
<span id="cb2-2"><a href="1.1-r-con-sql.html#cb2-2" aria-hidden="true"></a><span class="st">&quot;</span>)</span></code></pre></div>
<p>Vamos paso a paso
- con: la variable que asignamos arriba, es la “ruta del archivo” en este caso de la conexión a la base de dato s
- query: “Consulta” en español, aquí se escribe en lenguaje SQL para obtener datos
- SELECT: Seleccionar columnas, * significa todas, si ponemos alguna columna, solo se pedirá esa
- FROM: De qué tabla vamos a leer, ¿se nota? no hay esquema, así que lee por defecto el esquema “public”, un equivalente sería usar “public.comunas_chile”</p>
<p>Ahora, una vez ejecutada esa línea, la variable x, tendrá los datos de las comunas de Chile.</p>
<p>Aprender SQL no es necesario para usar las bases de datos desde R, no mucho más allá después de esto, hay paquetes de R que dan ayuda.</p>
<p>Aun así, aprender SQL es una muy buena opción si quieres poder obtener una gran gestión de datos y una buena eficiencia.</p>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="1-introduccion.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03.01-Consulta-datos-SQL.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
